(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){},5042:function(){},8101:function(e,t,r){Promise.resolve().then(r.bind(r,3290))},3290:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return RootLayout}});var i=r(7437),n=r(7793),s=r(2710),a=r(9792),o=r(245);let isMyCaptured=e=>e<o.Rg,isOpCaptured=e=>e>=o.Rg;var u=r(4346);let Captured=class Captured{getCapturedIndex(){return this.capturedIndex}getAmount(){return this.amount}setAmount(e){return new Captured(this.capturedIndex,e)}getKey(){return this.amount.toString()}constructor(e,t=0){this.capturedIndex=e,this.amount=t}};let Square=class Square{getPiece(){return this.piece}getIndex(){return this.index}isEmpty(){return(0,s.xb)(this.piece)}isPieceExists(){return!this.isEmpty()}setPiece(e){return new Square(this.index,e)}getKey(){return 10!==this.piece?this.piece.toString():"a"}turnState(){let e=(0,s.xb)(this.piece)?o.E_:(0,s.y3)(this.piece)?this.piece+5:this.piece-5;return new Square(this.index,e)}constructor(e,t=o.E_){this.index=e,this.piece=t}};let ShogiState=class ShogiState{static createInitialState(){let e=o.Bu.map((e,t)=>new Square(t,e)),t=o.o.map((e,t)=>new Captured(t,e));return new ShogiState(e,t)}static parseKey(e){let t=e.slice(0,12),r=e.slice(12),i=t.split("").map((e,t)=>new Square(t,"a"!==e?Number(e):10)),n=r.split("").map((e,t)=>new Captured(t,Number(e)));return(0,u.Z)(e).map(()=>new ShogiState(i,n))}getKey(){let e=this.board.map(e=>e.getKey()).join(""),t=this.captured.map(e=>e.getKey()).join("");return e+t}getPiece(e){return this.board[e].getPiece()}getAmount(e){return this.captured[e].getAmount()}movePiece(e,t){let r=this.board[e],i=this.board[t],n=r.setPiece(o.E_),u=i.setPiece(r.getPiece()),c=this.canMovePiece(r.getPiece(),e,t),l=i.isEmpty()||(0,s.Ww)(i.getPiece())?(0,a.ok)(this.captured):this.catchPiece(i.getPiece()),h=(()=>{let i=[...this.board];return i[e]=n,r.getPiece()===o.ZI&&t<3?i[t]=u.setPiece(o.Pn):r.getPiece()===o.Xs&&t>8?i[t]=u.setPiece(o.mh):i[t]=u,(0,a.ok)(i)})();return a.x4.combine([c,h,l]).map(e=>{let[t,r,i]=e;return new ShogiState(r,i)})}putPiece(e,t){let r=this.useCaptured(e),i=this.board[t];if(!i.isEmpty())return(0,a.cn)(Error());let n=(()=>{let r=(()=>{switch(e){case o.bD:return o.OS;case o.IH:return o.Vg;case o.Ah:return o.ZI;case o.Rg:return o.zq;case o.rD:return o.Dx;case o.y8:return o.Xs}})();if(void 0===r)return(0,a.cn)(Error());let n=[...this.board];return n[t]=i.setPiece(r),(0,a.ok)(n)})();return a.x4.combine([n,r]).map(e=>{let[t,r]=e;return new ShogiState(t,r)})}canMovePiece(e,t,r){let i=this.board[r];if((0,s.xb)(e)||(0,s.y3)(e)&&(0,s.y3)(i.getPiece())||(0,s.XE)(e)&&(0,s.XE)(i.getPiece()))return(0,a.cn)(Error());let n=ShogiState.getMove(e,t);return n.includes(r)?(0,a.ok)(void 0):(0,a.cn)(Error())}getNextStates(e){let t="ME"===e?s.y3:s.XE,r=this.board.map((e,r)=>t(e.getPiece())?Array(12).fill(void 0).map((e,t)=>{let i=this.movePiece(r,t);return i.isOk()?[i.value]:[]}).flat():[]).flat(),i="ME"===e?isMyCaptured:isOpCaptured,n=this.captured.map((e,t)=>i(t)&&0!==e.getAmount()?Array(12).fill(void 0).map((e,r)=>{let i=this.putPiece(t,r);return i.isOk()?[i.value]:[]}).flat():[]).flat();return[...r,...n]}isFinished(e){let t={isFinished:!0,winner:"ME"},r={isFinished:!0,winner:"OPPONENT"},i=this.board.findIndex(e=>e.getPiece()===o.xw),n=this.board.findIndex(e=>e.getPiece()===o.D_);return -1===i?r:-1===n?t:"ME"===e&&i<3?t:"OPPONENT"===e&&n>8?r:{isFinished:!1}}turnState(){let e=this.board.reverse().map(e=>e.turnState()),t=[...this.captured.slice(3),...this.captured.slice(0,3)];return new ShogiState(e,t)}catchPiece(e){let t=(()=>{switch(e){case o.zq:return o.bD;case o.Dx:return o.IH;case o.Xs:case o.mh:return o.Ah;case o.OS:return o.Rg;case o.Vg:return o.rD;case o.ZI:case o.Pn:return o.y8}})();if(void 0===t)return(0,a.cn)(Error());let r=this.captured[t],i=r.setAmount(r.getAmount()+1);return(0,a.ok)([...this.captured.slice(0,t),i,...this.captured.slice(t+1)])}useCaptured(e){let t=this.captured[e],r=t.getAmount();if(0===r)return(0,a.cn)(Error());let i=t.setAmount(r-1);return(0,a.ok)([...this.captured.slice(0,e),i,...this.captured.slice(e+1)])}static getMove(e,t){let r=(()=>{switch(e){case o.ZI:if(t>2)return[-3];break;case o.Xs:if(t<9)return[3];break;case o.xw:case o.D_:if(0===t)return[1,3,4];if(1===t)return[-1,1,2,3,4];if(2===t)return[-1,2,3];if(3===t||6===t)return[-3,-2,1,3,4];else if(4===t||7===t)return[-4,-3,-2,-1,1,2,3,4];else if(5===t||8===t)return[-4,-3,-1,2,3];else if(9===t)return[-3,-2,1];else if(10===t)return[-4,-3,-2,-1,1];else if(11===t)return[-4,-3,-1];case o.OS:case o.zq:if(0===t)return[4];if(1===t)return[2,4];if(2===t)return[2];if(3===t||6===t)return[-2,4];else if(4===t||7===t)return[-4,-2,2,4];else if(5===t||8===t)return[-4,2];else if(9===t)return[-2];else if(10===t)return[-4,-2];else if(11===t)return[-4];case o.Vg:case o.Dx:if(0===t)return[1,3];if(1===t)return[-1,1,3];if(2===t)return[-1,3];if(3===t||6===t)return[-3,1,3];else if(4===t||7===t)return[-3,-1,1,3];else if(5===t||8===t)return[-3,-1,3];else if(9===t)return[-3,1];else if(10===t)return[-3,-1,1];else if(11===t)return[-3,-1];case o.Pn:if(0===t)return[1,3];if(1===t)return[-1,1,3];if(2===t)return[-1,3];if(3===t||6===t)return[-3,-2,1,3];else if(4===t||7===t)return[-4,-3,-2,-1,1,3];else if(5===t||8===t)return[-4,-3,-1,3];else if(9===t)return[-3,-2,1];else if(10===t)return[-4,-3,-2,-1,1];else if(11===t)return[-4,-3,-1];case o.mh:if(0===t)return[1,3,4];if(1===t)return[-1,1,2,3,4];if(2===t)return[-1,2,3];if(3===t||6===t)return[-3,1,3,4];else if(4===t||7===t)return[-3,-1,1,2,3,4];else if(5===t||8===t)return[-3,-1,2,3];else if(9===t)return[-3,1];else if(10===t)return[-3,-1,1];else if(11===t)return[-3,-1]}return[]})();return r.map(e=>t+e)}constructor(e,t){this.board=e,this.captured=t}};let GameState=class GameState{static createInitialState(e){return new GameState(e)}getTurnPlayer(){return this.turnPlayer}toggleTurn(){return new GameState(this.playTypeStatus,"ME"===this.turnPlayer?"OPPONENT":"ME")}getSelectingAction(){return this.selectingAction}isFinished(){return"FINISHED"===this.finishStatus.type}getWinner(){return"NOTFINISH"===this.finishStatus.type?(0,a.cn)(Error()):(0,a.ok)(this.finishStatus.winner)}getPlayType(){switch(this.turnPlayer){case"ME":return this.playTypeStatus.me;case"OPPONENT":return this.playTypeStatus.opponent}}getPlayTypeStatus(){return this.playTypeStatus}setFinishStatus(e){return new GameState(this.playTypeStatus,this.turnPlayer,this.selectingAction,{type:"FINISHED",winner:e})}setSelectingAction(e){if(this.isFinished())return(0,a.cn)(Error());switch(e.type){case"BOARD":{let t=this.boardValidateion(e);if(t.isErr())return(0,a.cn)(t.error);return(0,a.ok)(new GameState(this.playTypeStatus,this.turnPlayer,e))}case"CAPTURED":{let t=this.capturedValidateion(e);if(t.isErr())return(0,a.cn)(t.error);return(0,a.ok)(new GameState(this.playTypeStatus,this.turnPlayer,e))}case"NONE":return(0,a.ok)(new GameState(this.playTypeStatus,this.turnPlayer,e))}}clearSelectingAction(){return new GameState(this.playTypeStatus,this.turnPlayer,{type:"NONE"})}boardValidateion(e){return"ME"===this.turnPlayer?(0,s.y3)(e.piece)?(0,a.ok)(void 0):(0,a.cn)(Error()):(0,s.XE)(e.piece)?(0,a.ok)(void 0):(0,a.cn)(Error())}capturedValidateion(e){return"ME"===this.turnPlayer?isMyCaptured(e.capturedIndex)?(0,a.ok)(void 0):(0,a.cn)(Error()):isOpCaptured(e.capturedIndex)?(0,a.ok)(void 0):(0,a.cn)(Error())}constructor(e,t="ME",r={type:"NONE"},i={type:"NOTFINISH"}){this.playTypeStatus=e,this.turnPlayer=t,this.selectingAction=r,this.finishStatus=i}};let Game=class Game{static createInitialState(e){return new Game(ShogiState.createInitialState(),GameState.createInitialState(e))}getSquareViewModel(e){let t=this.gameState.getSelectingAction(),r=this.shogiState.getPiece(e),i=(()=>{switch(t.type){case"NONE":return"inclickable";case"BOARD":{if(t.squareIndex===e)return"selecting";let r=this.shogiState.getPiece(t.squareIndex),i=this.shogiState.canMovePiece(r,t.squareIndex,e);return i.isOk()?"clickable":"inclickable"}case"CAPTURED":return(0,s.xb)(r)?"clickable":"inclickable"}})();return{piece:r,squareIndex:e,state:i}}getCapturedViewModel(e){let t=this.gameState.getSelectingAction(),r=this.shogiState.getAmount(e),i=(()=>{switch(t.type){case"NONE":case"BOARD":return"notselecting";case"CAPTURED":return e===t.capturedIndex?"selecting":"notselecting"}})();return{capturedIndex:e,amount:r,state:i}}getSystemViewModel(e){if(e)return{turnPlayer:"ME",finishStatus:{isFinished:!0,winner:"ME"},notStarted:!0,thinking:!1};let t=this.gameState.getWinner(),r=this.gameState.getTurnPlayer();return t.isErr()?{turnPlayer:r,finishStatus:{isFinished:!1},notStarted:!1,thinking:"STRATEGY"===this.gameState.getPlayType()}:{turnPlayer:r,finishStatus:{isFinished:!0,winner:t.value},notStarted:!1,thinking:!1}}isTurnForStrategy(){return"STRATEGY"===this.gameState.getPlayType()}clickBoard(e){let t=this.gameState.getPlayType();if("STRATEGY"===t)return(0,a.cn)(Error());let r=this.shogiState.getPiece(e),i=this.gameState.getSelectingAction();switch(i.type){case"NONE":{let t=this.gameState.setSelectingAction({type:"BOARD",squareIndex:e,piece:r});if(t.isErr())return(0,a.cn)(t.error);return(0,a.ok)(new Game(this.shogiState,t.value))}case"BOARD":if(i.squareIndex===e)return(0,a.ok)(this.clearState());{let t=this.shogiState.movePiece(i.squareIndex,e);if(t.isErr())return(0,a.cn)(t.error);return(0,a.ok)(this.turnEnd(t.value))}case"CAPTURED":{let t=this.shogiState.putPiece(i.capturedIndex,e);if(t.isErr())return(0,a.cn)(t.error);return(0,a.ok)(this.turnEnd(t.value))}}}clickCaptured(e){let t=this.gameState.getPlayType();if("STRATEGY"===t)return(0,a.cn)(Error());let r=this.gameState.getSelectingAction();if("CAPTURED"===r.type&&r.capturedIndex===e)return(0,a.ok)(this.clearState());{let t=this.gameState.setSelectingAction({type:"CAPTURED",capturedIndex:e});return t.isErr()?(0,a.cn)(t.error):(0,a.ok)(new Game(this.shogiState,t.value))}}selectNextState(e,t){let r=this.gameState.getPlayType();if("CLICK"===r)return(0,a.cn)(Error());let i=this.shogiState.getNextStates(this.gameState.getTurnPlayer()).map(e=>"OPPONENT"===t?e:e.turnState()).map(e=>e.getKey()),n=e(i);if(n.isErr())return(0,a.cn)(n.error);let s=ShogiState.parseKey(n.value);if(s.isErr())return(0,a.cn)(s.error);let o="OPPONENT"===t?s.value:s.value.turnState();return(0,a.ok)(this.turnEnd(o))}isFinished(){return this.gameState.isFinished()}getTurnPlayer(){return this.gameState.getTurnPlayer()}getPlayTypeStatus(){return this.gameState.getPlayTypeStatus()}turnEnd(e){let t=this.gameState.toggleTurn(),r=e.isFinished(t.getTurnPlayer());return r.isFinished?new Game(e,t.setFinishStatus(r.winner)):new Game(e,t)}clearState(){return new Game(this.shogiState,this.gameState.clearSelectingAction())}constructor(e,t){this.shogiState=e,this.gameState=t}};var c=r(7795),l=r.n(c);let h="click",m="game";let GameListener=class GameListener extends l(){emitGameEvent(e){this.emit(m,e)}onGameEvent(e){this.on(m,e)}emitClickEvent(e){this.emit(h,e)}onClickEvent(e){this.on(h,e)}};let StateListener=class StateListener extends l(){emitSquareViewModel(e,t){let r=this.squareCache.get(e);JSON.stringify(r)!==JSON.stringify(t)&&(this.squareCache.set(e,t),this.emit(this.makeSquareViewModelEventName(e),t))}onSquareViewModel(e,t){this.on(this.makeSquareViewModelEventName(e),t)}removeSquareViewModelListener(e,t){this.removeListener(this.makeSquareViewModelEventName(e),t)}emitCapturedViewModel(e,t){let r=this.capturedCache.get(e);JSON.stringify(r)!==JSON.stringify(t)&&(this.capturedCache.set(e,t),this.emit(this.makeCapturedViewModelEventName(e),t))}onCapturedViewModel(e,t){this.on(this.makeCapturedViewModelEventName(e),t)}removeCapturedViewModelListener(e,t){this.removeListener(this.makeCapturedViewModelEventName(e),t)}emitSystemViewModel(e){JSON.stringify(this.systemCache)!==JSON.stringify(e)&&(this.systemCache=e,this.emit(this.makeSystemViewModelEventName(),e))}onSystemViewModel(e){this.on(this.makeSystemViewModelEventName(),e)}removeSystemViewModelListener(e){this.removeListener(this.makeSystemViewModelEventName(),e)}makeSquareViewModelEventName(e){return"SQUARE_VIEW_MODEL"+e.toString()}makeCapturedViewModelEventName(e){return"CAPTURED_VIEW_MODEL"+e.toString()}makeSystemViewModelEventName(){return"SYSTEM_VIEW_MODEL"}constructor(...e){super(...e),this.squareCache=new Map,this.capturedCache=new Map,this.systemCache=void 0}};let System=class System{getGame(){return this.game}getGameListener(){return this.gameListner}getStateListener(){return this.stateListener}setModel(e){this.model=e}init(){this.gameListner.onGameEvent(e=>{switch(e.type){case"start":this.game=Game.createInitialState(e.playType);break;case"reset":this.game=Game.createInitialState(this.game.getPlayTypeStatus())}this.notStarted=!1,this.emitEvents()}),this.gameListner.onClickEvent(e=>{if(!this.notStarted){switch(e.type){case"BOARD":{let t=this.game.clickBoard(e.squareIndex);if(t.isErr())return;this.game=t.value;break}case"CAPTURED":{let t=this.game.clickCaptured(e.capturedIndex);if(t.isErr())return;this.game=t.value}}this.emitEvents()}}),this.modelListener.onStrategyEvent(e=>{let t=this.model;if(void 0===t){setTimeout(()=>{this.modelListener.emitStrategyEvent(e)},1500);return}let r=this.game.selectNextState(t.getChooseStrategy(),e.turnPlayer);r.isErr()||(this.game=r.value,this.emitEvents())})}emitEvents(){for(let e=0;e<12;e++)this.stateListener.emitSquareViewModel(e,this.game.getSquareViewModel(e));for(let e=0;e<6;e++)this.stateListener.emitCapturedViewModel(e,this.game.getCapturedViewModel(e));this.stateListener.emitSystemViewModel(this.game.getSystemViewModel(this.notStarted)),this.game.isTurnForStrategy()&&!this.game.isFinished()&&setTimeout(()=>{this.modelListener.emitStrategyEvent({turnPlayer:this.game.getTurnPlayer()})},1500)}constructor(e,t,r,i){this.gameListner=e,this.stateListener=t,this.modelListener=r,this.model=void 0,this.notStarted=!0,this.game=i,this.init()}};let ModelListener=class ModelListener extends l(){emitStrategyEvent(e){this.emit(this.makeStrategyEventName(),e)}onStrategyEvent(e){this.on(this.makeStrategyEventName(),e)}removeStrategyEventListener(e){this.removeListener(this.makeStrategyEventName(),e)}makeStrategyEventName(){return"strategy"}};function RootLayout(e){let{children:t}=e;return(0,i.jsx)(n.y.Provider,{value:new System(new GameListener,new StateListener,new ModelListener,Game.createInitialState({me:"CLICK",opponent:"CLICK"})),children:(0,i.jsx)("html",{lang:"jp",children:(0,i.jsx)("body",{children:t})})})}},245:function(e,t,r){"use strict";r.d(t,{Ah:function(){return g},Bu:function(){return S},D_:function(){return c},Dx:function(){return h},E_:function(){return i},IH:function(){return f},OS:function(){return s},Pn:function(){return u},Rg:function(){return y},Vg:function(){return a},Xs:function(){return m},ZI:function(){return o},bD:function(){return p},mh:function(){return d},o:function(){return w},rD:function(){return v},s3:function(){return L},xw:function(){return n},y8:function(){return E},zq:function(){return l}});let i=0,n=1,s=2,a=3,o=4,u=5,c=6,l=7,h=8,m=9,d=10,p=0,f=1,g=2,y=3,v=4,E=5,S=[h,c,l,i,m,i,i,o,i,s,n,a],w=[0,0,0,0,0,0],L=/([0-9]|a){12}[0-2]{6}/},7793:function(e,t,r){"use strict";r.d(t,{y:function(){return c},u:function(){return useSystem}});var i=r(6420),n=r(9792),s=r(9743),a=r.n(s),o=r(4346);let ModelData=class ModelData{static createData(e){let t=e.slice(0,12),r=e.slice(12),n=t.split("").map(e=>"a"!==e?Number(e):10).map(e=>ModelData.createOnehot(e,11)).flat(),s=r.split("").map(e=>Number(e)).map(e=>ModelData.createOnehot(e,3)).flat(),a=(0,i.XeE)([...n,...s],[1,150],"float32");return(0,o.Z)(e).map(()=>new ModelData(e,a))}static createOnehot(e,t){let r=Array(t).fill(0);return r[e]=1,r}getData(){return this.data}getKey(){return this.key}constructor(e,t){this.key=e,this.data=t}};let Model=class Model{static async load(e){let t=await (0,i.FBF)(a().join("/models",e,"model.json"));return new Model(t)}getChooseStrategy(){return e=>{let t=0,r=1/0;for(let i=0;i<e.length;i++){let s=e[i],a=this.predict(s);if(a.isErr())return(0,n.cn)(a.error);let o=a.value;o<r&&(t=i,r=o)}return(0,n.ok)(e[t])}}predict(e){if(this.cache.has(e))return(0,n.ok)(this.cache.get(e));let t=ModelData.createData(e);if(t.isErr())return(0,n.cn)(t.error);let r=this.model.predict(t.value.getData()),i=r.arraySync()[0][0];return this.cache.set(e,i),(0,n.ok)(i)}constructor(e){this.model=e,this.cache=new Map}};var u=r(2265);let c=(0,u.createContext)(void 0),useSystem=()=>{let e=(0,u.useContext)(c),t=(0,u.useCallback)(async t=>{let r=await Model.load(t);e.setModel(r)},[e]);return{game:e.getGame(),gameListener:e.getGameListener(),stateListener:e.getStateListener(),setModel:t}}},4346:function(e,t,r){"use strict";r.d(t,{Z:function(){return keyValidation}});var i=r(245),n=r(9792);let keyValidation=e=>i.s3.test(e)?(0,n.ok)(void 0):(0,n.cn)(Error())},2710:function(e,t,r){"use strict";r.d(t,{Ww:function(){return isLion},XE:function(){return isOpPiece},xb:function(){return isEmpty},y3:function(){return isMyPiece}});var i=r(245);let isMyPiece=e=>e!==i.E_&&e<i.D_,isOpPiece=e=>e>=i.D_,isEmpty=e=>e===i.E_,isLion=e=>e===i.xw||e===i.D_},7795:function(e){!function(){"use strict";var t={864:function(e){var t,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}e.exports=EventEmitter,e.exports.once=function(e,t){return new Promise(function(r,i){function errorListener(r){e.removeListener(t,resolver),i(r)}function resolver(){"function"==typeof e.removeListener&&e.removeListener("error",errorListener),r([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,resolver,{once:!0}),"error"!==t&&"function"==typeof e.on&&eventTargetAgnosticAddListener(e,"error",errorListener,{once:!0})})},EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var s=10;function checkListener(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,r,i){if(checkListener(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),a=s[t]),void 0===a)a=s[t]=r,++e._eventsCount;else if("function"==typeof a?a=s[t]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),(n=_getMaxListeners(e))>0&&a.length>n&&!a.warned){a.warned=!0;var n,s,a,o=Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=a.length,console&&console.warn&&console.warn(o)}return e}function onceWrapper(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=onceWrapper.bind(i);return n.listener=r,i.wrapFn=n,n}function _listeners(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):arrayClone(n,n.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function arrayClone(e,t){for(var r=Array(t),i=0;i<t;++i)r[i]=e[i];return r}function eventTargetAgnosticAddListener(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function wrapListener(n){i.once&&e.removeEventListener(t,wrapListener),r(n)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||n(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),EventEmitter.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var a,o=Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var u=s[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else for(var c=u.length,l=arrayClone(u,c),r=0;r<c;++r)i(l[r],this,t);return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var r,i,n,s,a;if(checkListener(t),void 0===(i=this._events)||void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){a=r[s].listener,n=s;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var n,s=Object.keys(r);for(i=0;i<s.length;++i)"removeListener"!==(n=s[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}}},r={};function __nccwpck_require__(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={exports:{}},s=!0;try{t[e](n,n.exports,__nccwpck_require__),s=!1}finally{s&&delete r[e]}return n.exports}__nccwpck_require__.ab="//";var i=__nccwpck_require__(864);e.exports=i}()}},function(e){e.O(0,[566,425,938,636,663,498,399,967,807,971,472,744],function(){return e(e.s=8101)}),_N_E=e.O()}]);